<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🛸 Monero Node Dashboard - Alien Control</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Orbitron', monospace;
            background: 
                radial-gradient(ellipse at 20% 30%, rgba(138, 43, 226, 0.4) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 70%, rgba(75, 0, 130, 0.35) 0%, transparent 45%),
                radial-gradient(ellipse at 60% 10%, rgba(25, 25, 112, 0.3) 0%, transparent 40%),
                radial-gradient(ellipse at 40% 80%, rgba(72, 61, 139, 0.25) 0%, transparent 35%),
                #000000;
            color: #00ff41;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        /* Small white stars - Layer 1 */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 1.5px;
            height: 1.5px;
            background: transparent;
            pointer-events: none;
            z-index: -2;
            box-shadow: 
                185px 78px #ffffff, 1240px 305px #ffffff, 678px 1420px #ffffff, 1456px 985px #ffffff,
                789px 234px #ffffff, 1678px 567px #ffffff, 234px 1234px #ffffff, 1890px 456px #ffffff,
                567px 890px #ffffff, 1234px 123px #ffffff, 890px 1567px #ffffff, 456px 789px #ffffff,
                1567px 234px #ffffff, 234px 567px #ffffff, 789px 1890px #ffffff, 1123px 456px #ffffff,
                345px 1234px #ffffff, 1789px 789px #ffffff, 678px 345px #ffffff, 1456px 1123px #ffffff,
                901px 567px #ffffff, 234px 1789px #ffffff, 1567px 678px #ffffff, 456px 234px #ffffff,
                1234px 901px #ffffff, 789px 456px #ffffff, 345px 1567px #ffffff, 1890px 789px #ffffff,
                678px 1234px #ffffff, 1123px 345px #ffffff, 567px 1890px #ffffff, 1789px 567px #ffffff,
                234px 1123px #ffffff, 901px 789px #ffffff, 1456px 234px #ffffff, 345px 901px #ffffff,
                1567px 1456px #ffffff, 678px 345px #ffffff, 789px 1567px #ffffff, 1890px 678px #ffffff,
                423px 1298px #ffffff, 1657px 432px #ffffff, 298px 865px #ffffff, 1532px 743px #ffffff,
                876px 198px #ffffff, 109px 1476px #ffffff, 1798px 321px #ffffff, 543px 1087px #ffffff,
                1321px 654px #ffffff, 765px 1543px #ffffff, 87px 976px #ffffff, 1654px 187px #ffffff,
                325px 567px #ffffff, 1845px 234px #ffffff, 756px 1123px #ffffff, 234px 678px #ffffff,
                1567px 890px #ffffff, 890px 345px #ffffff, 345px 1456px #ffffff, 1234px 567px #ffffff,
                678px 1789px #ffffff, 1456px 123px #ffffff, 123px 1234px #ffffff, 1789px 890px #ffffff,
                567px 456px #ffffff, 1123px 1567px #ffffff, 456px 345px #ffffff, 1890px 1234px #ffffff,
                234px 789px #ffffff, 1678px 456px #ffffff, 789px 123px #ffffff, 123px 1678px #ffffff,
                1456px 789px #ffffff, 345px 234px #ffffff, 1234px 1456px #ffffff, 678px 567px #ffffff,
                1567px 123px #ffffff, 890px 1789px #ffffff, 456px 678px #ffffff, 1789px 345px #ffffff,
                234px 1567px #ffffff, 1123px 234px #ffffff, 567px 1456px #ffffff, 1890px 678px #ffffff,
                345px 890px #ffffff, 1678px 1123px #ffffff, 789px 234px #ffffff, 234px 456px #ffffff,
                1456px 1678px #ffffff, 123px 567px #ffffff, 1234px 890px #ffffff, 678px 1234px #ffffff,
                1567px 456px #ffffff, 890px 1567px #ffffff, 456px 123px #ffffff, 1789px 1890px #ffffff,
                567px 789px #ffffff, 1123px 345px #ffffff, 345px 1123px #ffffff, 1890px 567px #ffffff,
                234px 234px #ffffff, 1678px 1678px #ffffff, 789px 456px #ffffff, 456px 1789px #ffffff,
                1456px 890px #ffffff, 123px 345px #ffffff, 1234px 1234px #ffffff, 678px 123px #ffffff,
                1567px 1567px #ffffff, 890px 678px #ffffff, 456px 890px #ffffff, 1789px 234px #ffffff,
                567px 1456px #ffffff, 1123px 789px #ffffff, 345px 567px #ffffff, 1890px 1123px #ffffff,
                234px 345px #ffffff, 1678px 234px #ffffff, 789px 1678px #ffffff, 456px 456px #ffffff,
                1456px 567px #ffffff, 123px 1890px #ffffff, 1234px 123px #ffffff, 678px 1456px #ffffff,
                1567px 789px #ffffff, 890px 234px #ffffff, 456px 1567px #ffffff, 1789px 678px #ffffff,
                567px 123px #ffffff, 1123px 1456px #ffffff, 345px 789px #ffffff, 1890px 890px #ffffff,
                234px 1123px #ffffff, 1678px 567px #ffffff, 789px 345px #ffffff, 456px 1234px #ffffff,
                1456px 678px #ffffff, 123px 1789px #ffffff, 1234px 456px #ffffff, 678px 890px #ffffff,
                1567px 345px #ffffff, 890px 1678px #ffffff, 456px 567px #ffffff, 1789px 123px #ffffff,
                567px 1234px #ffffff, 1123px 890px #ffffff, 345px 456px #ffffff, 1890px 1456px #ffffff,
                234px 1678px #ffffff, 1678px 789px #ffffff, 789px 567px #ffffff, 456px 345px #ffffff,
                1456px 1123px #ffffff, 123px 234px #ffffff, 1234px 1789px #ffffff, 678px 678px #ffffff,
                1567px 234px #ffffff, 890px 1456px #ffffff, 456px 789px #ffffff, 1789px 456px #ffffff,
                567px 345px #ffffff, 1123px 1234px #ffffff, 345px 678px #ffffff, 1890px 345px #ffffff,
                234px 890px #ffffff, 1678px 1567px #ffffff, 789px 123px #ffffff, 456px 1678px #ffffff,
                1456px 345px #ffffff, 123px 789px #ffffff, 1234px 234px #ffffff, 678px 1567px #ffffff,
                1567px 678px #ffffff, 890px 456px #ffffff, 456px 1234px #ffffff, 1789px 890px #ffffff,
                567px 567px #ffffff, 1123px 123px #ffffff, 345px 1789px #ffffff, 1890px 234px #ffffff,
                234px 456px #ffffff, 1678px 345px #ffffff, 789px 890px #ffffff, 456px 678px #ffffff,
                1456px 1456px #ffffff, 123px 1123px #ffffff, 1234px 567px #ffffff, 678px 234px #ffffff,
                1567px 1890px #ffffff, 890px 345px #ffffff, 456px 1456px #ffffff, 1789px 1234px #ffffff,
                567px 678px #ffffff, 1123px 456px #ffffff, 345px 123px #ffffff, 1890px 789px #ffffff;
            animation: twinkle 8s ease-in-out infinite;
        }
        
        /* Subtle sparkly orbs - Layer 2 */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 4.5px;
            height: 4.5px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.6) 0%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
            z-index: -1;
            box-shadow:
                320px 150px 2px rgba(135, 206, 235, 0.2), 1100px 600px 1px rgba(255, 215, 0, 0.25), 850px 1200px 2px rgba(255, 105, 180, 0.15),
                1350px 300px 1px rgba(0, 206, 209, 0.2), 450px 800px 2px rgba(221, 160, 221, 0.18), 1550px 450px 1px rgba(152, 251, 152, 0.15),
                200px 1350px 2px rgba(240, 230, 140, 0.12), 1750px 750px 1px rgba(255, 160, 122, 0.2), 650px 250px 2px rgba(32, 178, 170, 0.16),
                950px 1450px 1px rgba(222, 184, 135, 0.14), 1250px 550px 2px rgba(176, 196, 222, 0.18), 550px 950px 1px rgba(245, 222, 179, 0.12),
                1650px 100px 2px rgba(255, 182, 193, 0.15), 350px 1250px 1px rgba(211, 211, 211, 0.1), 1050px 650px 2px rgba(255, 239, 213, 0.12),
                750px 350px 1px rgba(224, 255, 255, 0.15), 1450px 1050px 2px rgba(255, 228, 225, 0.1), 250px 750px 1px rgba(240, 255, 240, 0.12),
                1850px 850px 2px rgba(255, 248, 220, 0.14), 150px 450px 1px rgba(255, 250, 205, 0.16), 1150px 1150px 2px rgba(253, 245, 230, 0.1),
                850px 50px 1px rgba(250, 240, 230, 0.12), 450px 1550px 2px rgba(255, 245, 238, 0.14), 1550px 250px 1px rgba(245, 255, 250, 0.1),
                980px 720px 2px rgba(230, 230, 250, 0.15), 1420px 380px 1px rgba(255, 240, 245, 0.12), 280px 1180px 2px rgba(255, 239, 213, 0.1),
                1720px 580px 1px rgba(240, 248, 255, 0.14), 420px 980px 2px rgba(135, 206, 235, 0.16), 1620px 280px 1px rgba(255, 215, 0, 0.18),
                780px 1380px 2px rgba(255, 105, 180, 0.12), 1480px 680px 1px rgba(0, 206, 209, 0.15), 180px 1480px 2px rgba(221, 160, 221, 0.14),
                1380px 180px 1px rgba(152, 251, 152, 0.12), 580px 1180px 2px rgba(240, 230, 140, 0.1), 1780px 580px 1px rgba(255, 160, 122, 0.16),
                380px 880px 2px rgba(32, 178, 170, 0.12), 1680px 380px 1px rgba(222, 184, 135, 0.1), 880px 1680px 2px rgba(176, 196, 222, 0.14),
                80px 1080px 1px rgba(245, 222, 179, 0.1), 1580px 480px 2px rgba(255, 182, 193, 0.12), 480px 1580px 1px rgba(211, 211, 211, 0.08);
            animation: sparkle 12s ease-in-out infinite reverse;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.4; }
            25% { opacity: 0.7; }
            50% { opacity: 1; }
            75% { opacity: 0.6; }
        }
        
        @keyframes sparkle {
            0%, 100% { opacity: 0.2; transform: scale(1); }
            25% { opacity: 0.4; transform: scale(1.1); }
            50% { opacity: 0.6; transform: scale(1.2); }
            75% { opacity: 0.3; transform: scale(1.05); }
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 10;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }
        
        .header h1 {
            font-size: 3em;
            font-weight: 900;
            color: #00ff41;
            text-shadow: 0 0 5px #00ff41, 0 0 10px #00ff41;
            animation: pulse 7s ease-in-out infinite;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            font-size: 1.2em;
            color: #39ff14;
            opacity: 0.8;
        }
        
        @keyframes pulse {
            0%, 100% { text-shadow: 0 0 5px #00ff41, 0 0 10px #00ff41; }
            50% { text-shadow: 0 0 6px #00ff41, 0 0 12px #00ff41, 0 0 14px #00ff41; }
        }
        
        .status-indicator {
            position: absolute;
            top: 10px;
            right: 20px;
            padding: 10px 20px;
            border: 2px solid #00ff41;
            border-radius: 25px;
            background: rgba(0, 255, 65, 0.1);
            font-weight: bold;
            animation: glow 66s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { box-shadow: 0 0 2px #00ff41; }
            to { box-shadow: 0 0 5px #00ff41, 0 0 8px #00ff41; }
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: linear-gradient(135deg, rgba(0, 255, 65, 0.1), rgba(57, 255, 20, 0.05));
            border: 2px solid #00ff41;
            border-radius: 15px;
            padding: 25px;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 65, 0.15), transparent);
            animation: scan 8s ease-in-out infinite;
        }
        
        @keyframes scan {
            0% { left: -100%; transform: translateX(0); }
            50% { transform: translateX(10px); }
            100% { left: 100%; transform: translateX(0); }
        }
        
        .card-title {
            font-size: 1.4em;
            font-weight: 700;
            margin-bottom: 15px;
            color: #39ff14;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 255, 65, 0.2);
        }
        
        .metric-label {
            color: #7fff00;
            font-size: 0.9em;
        }
        
        .metric-value {
            color: #00ff41;
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .big-number {
            font-size: 2.5em;
            font-weight: 900;
            text-align: center;
            color: #00ff41;
            text-shadow: 0 0 5px #00ff41;
        }
        
        .connections-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .connection-item {
            background: rgba(0, 255, 65, 0.1);
            border: 1px solid #00ff41;
            border-radius: 8px;
            padding: 10px;
            font-size: 0.8em;
        }
        
        .error-message {
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.2), rgba(255, 100, 100, 0.1));
            border: 2px solid #ff0040;
            color: #ff4040;
            text-align: center;
            padding: 20px;
            border-radius: 10px;
        }
        
        .loading {
            text-align: center;
            font-size: 1.2em;
            color: #39ff14;
            animation: loadingPulse 7s ease-in-out infinite;
        }
        
        @keyframes loadingPulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }
        
        .chart-container {
            height: 200px;
            position: relative;
            background: rgba(0, 255, 65, 0.05);
            border-radius: 10px;
            margin-top: 15px;
        }
        
        @media (max-width: 768px) {
            .header h1 { font-size: 2em; }
            .grid { grid-template-columns: 1fr; }
            .status-indicator { position: static; margin: 10px auto; }
        }
        
        .alien-eye {
            position: fixed;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.6) 0%, rgba(0, 255, 65, 0.4) 30%, rgba(57, 255, 20, 0.25) 70%, transparent 100%);
            opacity: 0.5;
            z-index: -3;
            animation: alienSparkle 6s ease-in-out infinite, float 9s ease-in-out infinite;
            box-shadow: 
                0 0 15px rgba(0, 255, 65, 0.2),
                inset 0 0 8px rgba(255, 255, 255, 0.3),
                inset 3px -3px 8px rgba(0, 255, 65, 0.15);
            backdrop-filter: blur(1px);
        }
        
        .alien-eye:nth-child(1) {
            top: 10%;
            left: 5%;
            animation-delay: 0s;
        }
        
        .alien-eye:nth-child(2) {
            top: 20%;
            right: 8%;
            animation-delay: 1.5s;
        }
        
        .alien-eye:nth-child(3) {
            bottom: 15%;
            left: 10%;
            animation-delay: 3s;
        }
        
        @keyframes alienSparkle {
            0%, 100% { opacity: 0.3; transform: scale(1) rotate(0deg); }
            25% { opacity: 0.5; transform: scale(1.1) rotate(90deg); }
            50% { opacity: 0.7; transform: scale(1.15) rotate(180deg); }
            75% { opacity: 0.4; transform: scale(1.05) rotate(270deg); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) translateX(0px); }
            25% { transform: translateY(-8px) translateX(3px); }
            50% { transform: translateY(-5px) translateX(-3px); }
            75% { transform: translateY(8px) translateX(2px); }
        }
    </style>
</head>
<body>
    <div class="alien-eye"></div>
    <div class="alien-eye"></div>
    <div class="alien-eye"></div>
    
    <div class="container">
        <header class="header">
            <h1>🛸 MONERO NODE CONTROL 🛸</h1>
            <p class="subtitle">Alien Technology Dashboard</p>
            <div class="status-indicator" id="statusIndicator">
                <span id="nodeStatus">SCANNING...</span>
            </div>
        </header>
        
        <div id="dashboardContent" class="loading">
            <p>🛸 Establishing connection with mothership...</p>
        </div>
    </div>
    
    <script>
        let lastUpdateTime = 0;
        
        function formatNumber(num) {
            if (num >= 1000000000) return (num / 1000000000).toFixed(2) + 'B';
            if (num >= 1000000) return (num / 1000000).toFixed(2) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(2) + 'K';
            return num?.toString() || 'N/A';
        }
        
        function formatBytes(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        function formatDuration(seconds) {
            const days = Math.floor(seconds / 86400);
            const hours = Math.floor((seconds % 86400) / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            return `${days}d ${hours}h ${minutes}m`;
        }
        
        function createDashboard(data) {
            const { node_info, last_block, connections, fees, node_status } = data;
            
            // Update status indicator
            const statusEl = document.getElementById('nodeStatus');
            const statusIndicator = document.getElementById('statusIndicator');
            if (node_status === 'online') {
                statusEl.textContent = '🟢 ONLINE';
                statusIndicator.style.borderColor = '#00ff41';
                statusIndicator.style.background = 'rgba(0, 255, 65, 0.2)';
            } else {
                statusEl.textContent = '🔴 OFFLINE';
                statusIndicator.style.borderColor = '#ff0040';
                statusIndicator.style.background = 'rgba(255, 0, 64, 0.2)';
            }
            
            if (node_status === 'offline') {
                return '<div class="error-message">🛸 Connection to mothership lost! Check Monero node at 192.168.122.185:18081</div>';
            }
            
            let html = '<div class="grid">';
            
            // Network Info Card
            html += `
                <div class="card">
                    <h3 class="card-title">👽 Network Status</h3>
                    <div class="metric">
                        <span class="metric-label">Block Height</span>
                        <span class="metric-value">${formatNumber(node_info?.height || 0)}</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Connections</span>
                        <span class="metric-value">${node_info?.outgoing_connections_count + node_info?.incoming_connections_count || 0}</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Difficulty</span>
                        <span class="metric-value">${formatNumber(node_info?.difficulty || 0)}</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Hash Rate</span>
                        <span class="metric-value">${formatNumber(node_info?.difficulty / 120 || 0)} H/s</span>
                    </div>
                </div>
            `;
            
            // Sync Status Card
            html += `
                <div class="card">
                    <h3 class="card-title">🔄 Synchronization</h3>
                    <div class="metric">
                        <span class="metric-label">Sync Status</span>
                        <span class="metric-value">${node_info?.synchronized ? '✅ SYNCED' : '⏳ SYNCING'}</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Target Height</span>
                        <span class="metric-value">${formatNumber(node_info?.target_height || 0)}</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Database Size</span>
                        <span class="metric-value">${formatBytes(node_info?.database_size || 0)}</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Version</span>
                        <span class="metric-value">${node_info?.version || 'Unknown'}</span>
                    </div>
                </div>
            `;
            
            // Latest Block Card
            if (last_block?.block_header) {
                const block = last_block.block_header;
                html += `
                    <div class="card">
                        <h3 class="card-title">🧊 Latest Block</h3>
                        <div class="big-number">#${formatNumber(block.height)}</div>
                        <div class="metric">
                            <span class="metric-label">Timestamp</span>
                            <span class="metric-value">${new Date(block.timestamp * 1000).toLocaleString()}</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Size</span>
                            <span class="metric-value">${formatBytes(block.block_size)}</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Reward</span>
                            <span class="metric-value">${(block.reward / 1e12).toFixed(4)} XMR</span>
                        </div>
                    </div>
                `;
            }
            
            // Fee Information
            if (fees && fees.fee) {
                html += `
                    <div class="card">
                        <h3 class="card-title">💰 Transaction Fees</h3>
                        <div class="metric">
                            <span class="metric-label">Current Fee</span>
                            <span class="metric-value">${(fees.fee / 1e12).toFixed(6)} XMR</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Fee per KB</span>
                            <span class="metric-value">${formatNumber(fees.fee)} atomic</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Priority</span>
                            <span class="metric-value">${fees.priority || 'Normal'}</span>
                        </div>
                    </div>
                `;
            }
            
            html += '</div>';
            
            // Connections detailed view
            if (connections && connections.connections && connections.connections.length > 0) {
                html += `
                    <div class="card" style="grid-column: 1 / -1;">
                        <h3 class="card-title">🌐 Active Connections (${connections.connections.length})</h3>
                        <div class="connections-grid">
                `;
                
                connections.connections.slice(0, 12).forEach(conn => {
                    html += `
                        <div class="connection-item">
                            <div><strong>IP:</strong> ${conn.address}</div>
                            <div><strong>Height:</strong> ${formatNumber(conn.height)}</div>
                            <div><strong>State:</strong> ${conn.state}</div>
                        </div>
                    `;
                });
                
                html += '</div></div>';
            }
            
            return html;
        }
        
        async function updateDashboard() {
            try {
                const response = await fetch('/api/data');
                const data = await response.json();
                
                document.getElementById('dashboardContent').innerHTML = createDashboard(data);
                lastUpdateTime = Date.now();
                
            } catch (error) {
                console.error('Error updating dashboard:', error);
                document.getElementById('dashboardContent').innerHTML = 
                    '<div class="error-message">🛸 Communication with mothership failed!</div>';
            }
        }
        
        // Update dashboard immediately and then every 10 seconds
        updateDashboard();
        setInterval(updateDashboard, 10000);
        
        // Add some alien effects
        setInterval(() => {
            const eyes = document.querySelectorAll('.alien-eye');
            eyes.forEach(eye => {
                eye.style.left = Math.random() * 100 + '%';
                eye.style.top = Math.random() * 100 + '%';
            });
        }, 15000);
        
    </script>
</body>
</html>